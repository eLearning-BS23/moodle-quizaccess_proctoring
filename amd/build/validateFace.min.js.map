{"version":3,"file":"validateFace.min.js","sources":["../src/validateFace.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/notification', 'core/str'],\n    function($, Ajax, Notification, Str) {\n        return {\n            setup: function() {\n\n                const loadStrings = async function() {\n                    const stringkeys = [\n                        {key: 'wrong_during_taking_image', component: 'quizaccess_proctoring'},\n                    ];\n                    try {\n                        const strings = await Str.get_strings(stringkeys);\n                        return {\n                            wrong_during_taking_image: strings[0],\n                        };\n                    } catch (error) {\n                        Notification.exception(error);\n                    }\n                };\n\n                $(\"#fgroup_id_buttonar\").css(\"padding\", \"5px\");\n\n                $(\"#fcvalidate\").click(async function(event) {\n                    event.preventDefault();\n                    const photo = document.getElementById('photo');\n                    const canvas = document.getElementById('canvas');\n                    const video = document.getElementById('video');\n                    const context = canvas.getContext('2d');\n                    context.drawImage(video, 0, 0, canvas.width, canvas.height);\n                    const data = canvas.toDataURL('image/png');\n                    photo.setAttribute('src', data);\n\n                    const courseid = document.getElementById('courseidval').value;\n                    const cmid = document.getElementById('cmidval').value;\n                    const profileimage = document.getElementById('profileimage').value;\n                    const wsfunction = 'quizaccess_proctoring_validate_face';\n                    const params = {\n                        'courseid': courseid,\n                        'cmid': cmid,\n                        'profileimage': profileimage,\n                        'webcampicture': data,\n                    };\n\n                    const request = {\n                        methodname: wsfunction,\n                        args: params\n                    };\n\n                    const strings = await loadStrings(); // Load localized strings.\n\n                    Ajax.call([request])[0].done(function(res) {\n                        if (res.warnings.length < 1) {\n                            const status = res.status;\n                            if (status === 'success') {\n                                $(\"#video\").css(\"border\", \"10px solid green\");\n                                document.getElementById(\"validate_form\").style.display = \"none\";\n                                document.getElementById(\"accept_form\").style.display = \"block\";\n                            } else {\n                                $(\"#video\").css(\"border\", \"10px solid red\");\n                            }\n                        } else {\n                            if (video) {\n                                Notification.addNotification({\n                                    message: strings.wrong_during_taking_image,\n                                    type: 'error'\n                                });\n                            }\n                        }\n                    }).fail(Notification.exception);\n\n                });\n                return true;\n            }\n        };\n    });\n"],"names":["define","$","Ajax","Notification","Str","setup","css","click","async","event","preventDefault","photo","document","getElementById","canvas","video","getContext","drawImage","width","height","data","toDataURL","setAttribute","request","methodname","args","value","strings","stringkeys","key","component","wrong_during_taking_image","get_strings","error","exception","loadStrings","call","done","res","warnings","length","status","style","display","addNotification","message","type","fail"],"mappings":"AAAAA,4CAAO,CAAC,SAAU,YAAa,oBAAqB,aAChD,SAASC,EAAGC,KAAMC,aAAcC,WACrB,CACHC,MAAO,kBAgBHJ,EAAE,uBAAuBK,IAAI,UAAW,OAExCL,EAAE,eAAeM,OAAMC,eAAeC,OAClCA,MAAMC,uBACAC,MAAQC,SAASC,eAAe,SAChCC,OAASF,SAASC,eAAe,UACjCE,MAAQH,SAASC,eAAe,SACtBC,OAAOE,WAAW,MAC1BC,UAAUF,MAAO,EAAG,EAAGD,OAAOI,MAAOJ,OAAOK,cAC9CC,KAAON,OAAOO,UAAU,aAC9BV,MAAMW,aAAa,MAAOF,YAapBG,QAAU,CACZC,WATe,sCAUfC,KATW,UAJEb,SAASC,eAAe,eAAea,WAC3Cd,SAASC,eAAe,WAAWa,mBAC3Bd,SAASC,eAAe,gBAAgBa,oBAMxCN,OAQfO,cA1CUnB,uBACVoB,WAAa,CACf,CAACC,IAAK,4BAA6BC,UAAW,oCAIvC,CACHC,iCAFkB3B,IAAI4B,YAAYJ,aAEC,IAEzC,MAAOK,OACL9B,aAAa+B,UAAUD,QAgCLE,GAEtBjC,KAAKkC,KAAK,CAACb,UAAU,GAAGc,MAAK,SAASC,QAC9BA,IAAIC,SAASC,OAAS,EAAG,CAEV,YADAF,IAAIG,QAEfxC,EAAE,UAAUK,IAAI,SAAU,oBAC1BM,SAASC,eAAe,iBAAiB6B,MAAMC,QAAU,OACzD/B,SAASC,eAAe,eAAe6B,MAAMC,QAAU,SAEvD1C,EAAE,UAAUK,IAAI,SAAU,uBAG1BS,OACAZ,aAAayC,gBAAgB,CACzBC,QAASlB,QAAQI,0BACjBe,KAAM,aAInBC,KAAK5C,aAAa+B,eAGlB"}