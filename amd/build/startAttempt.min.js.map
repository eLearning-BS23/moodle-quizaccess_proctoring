{"version":3,"sources":["../src/startAttempt.js"],"names":["define","$","Ajax","Notification","setup","props","console","log","examurl","click","event","preventDefault","photo","document","getElementById","canvas","video","context","getContext","drawImage","width","height","data","toDataURL","setAttribute","courseid","value","cmid","profileimage","style","display","call","methodname","args","done","res","warnings","length","status","css","html","addNotification","message","type","fail","exception"],"mappings":"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","sourcesContent":["define(['jquery', 'core/ajax', 'core/notification'],\r\n    function($, Ajax, Notification) {\r\n        return {\r\n            setup: function(props) {\r\n                console.log(props.examurl);\r\n                var quizwindow;\r\n                \r\n                $(\"#fcvalidate\").click(function(event) {\r\n                    event.preventDefault();\r\n                    const photo = document.getElementById('photo');\r\n                    const canvas = document.getElementById('canvas');\r\n                    const video = document.getElementById('video');\r\n                    const context = canvas.getContext('2d');\r\n                    context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n                    var data = canvas.toDataURL('image/png');\r\n                    photo.setAttribute('src', data);\r\n\r\n                    const courseid = document.getElementById('courseidval').value;\r\n                    const cmid = document.getElementById('cmidval').value;\r\n                    const profileimage = document.getElementById('profileimage').value;\r\n\r\n                    const wsfunction = 'quizaccess_proctoring_validate_face';\r\n                    const params = {\r\n                        'courseid': courseid,\r\n                        'cmid': cmid,\r\n                        'profileimage': profileimage,\r\n                        'webcampicture': data,\r\n                    };\r\n\r\n                    const request = {\r\n                        methodname: wsfunction,\r\n                        args: params\r\n                    };\r\n                    document.getElementById('loading_spinner').style.display = 'block';\r\n                    Ajax.call([request])[0].done(function(res) {\r\n                        if (res.warnings.length < 1) {\r\n                            document.getElementById('loading_spinner').style.display = 'none';\r\n                            var status = res.status;\r\n                            if (status === 'success') {\r\n                                $(\"#video\").css(\"border\", \"10px solid green\");\r\n                                $(\"#face_validation_result\").html('<span style=\"color: green\">True</span>');\r\n                                document.getElementById(\"fcvalidate\").style.display = \"none\";\r\n                                $(\"#form_activate\").css(\"visibility\", \"visible\");\r\n                            } else {\r\n                                $(\"#video\").css(\"border\", \"10px solid red\");\r\n                                $(\"#face_validation_result\").html('<span style=\"color: red\">False</span>');\r\n                            }\r\n                        } else {\r\n                            document.getElementById('loading_spinner').style.display = 'none';\r\n                            if (video) {\r\n                                Notification.addNotification({\r\n                                    message: 'Something went wrong during taking the image.',\r\n                                    type: 'error'\r\n                                });\r\n                            }\r\n                        }\r\n                    }).fail(Notification.exception);\r\n\r\n                });\r\n\r\n                return true;\r\n            }\r\n        };\r\n    });\r\n"],"file":"startAttempt.min.js"}